<<<<<<< Updated upstream

(pymag) C:\Users\teeds\Desktop\projects\pymagindev\retry>python main.py ./test/test_example10/test.py
=================================================================================================
FILE_TOKEN:
./test/test_example10/test.py
CLASS NAME
ReActGeneralStrategy
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
FUNC TOKEN
generate
INPUT LIST
['self', 'question', 'examples', 'prompt', 'additional_keys', 'reset']
OUTPUT LIST
['out']
AFter process
[Variable token=start point_to=[<Call func=time line_no=70 parent_token=time taken_var=[]>] line_no=70]

LogicStatement cond=if else=None
if 1
['reset']
<Call func=reset line_no=73 parent_token=self taken_var=[]>


[Variable token=scratchpad point_to=['Constant'] line_no=75]

[Variable token=answer point_to=['Constant'] line_no=76]

[Variable token=finished point_to=['Constant'] line_no=77]

[Variable token=idx point_to=['Constant'] line_no=78]

[Variable token=steps point_to=['List'] line_no=79]

LogicStatement cond=while else=None
while 1
[<Call func=halting_condition line_no=80 parent_token=self taken_var=['finished', 'idx', 'question', 'scratchpad', 'examples', 'prompt', 'additional_keys']>]
[Variable token=scratchpad point_to=[<Call func=generate_thought line_no=90 parent_token=self taken_var=['idx', 'scratchpad', 'question', 'examples', 'prompt', 'additional_keys']>] line_no=90, Variable token=thought point_to=[<Call func=generate_thought line_no=90 parent_token=self taken_var=['idx', 'scratchpad', 'question', 'examples', 'prompt', 'additional_keys']>] line_no=90, Variable token=thought_response point_to=[<Call func=generate_thought line_no=90 parent_token=self taken_var=['idx', 'scratchpad', 'question', 'examples', 'prompt', 'additional_keys']>] line_no=90]

[Variable token=scratchpad point_to=[<Call func=generate_action line_no=100 parent_token=self taken_var=['idx', 'scratchpad', 'question', 'examples', 'prompt', 'additional_keys']>] line_no=100, Variable token=action_type point_to=[<Call func=generate_action line_no=100 parent_token=self taken_var=['idx', 'scratchpad', 'question', 'examples', 'prompt', 'additional_keys']>] line_no=100, Variable token=query point_to=[<Call func=generate_action line_no=100 parent_token=self taken_var=['idx', 'scratchpad', 'question', 'examples', 'prompt', 'additional_keys']>] line_no=100, Variable token=action_response point_to=[<Call func=generate_action line_no=100 parent_token=self taken_var=['idx', 'scratchpad', 'question', 'examples', 'prompt', 'additional_keys']>] line_no=100]       

[Variable token=scratchpad point_to=[<Call func=generate_observation line_no=111 parent_token=self taken_var=['idx', 'scratchpad', 'action_type', 'query']>] line_no=110, Variable token=answer point_to=[<Call func=generate_observation line_no=111 parent_token=self taken_var=['idx', 'scratchpad', 'action_type', 'query']>] line_no=110, Variable token=obs point_to=[<Call func=generate_observation line_no=111 parent_token=self taken_var=['idx', 'scratchpad', 'action_type', 'query']>] line_no=110, Variable token=finished point_to=[<Call func=generate_observation line_no=111 parent_token=self taken_var=['idx', 'scratchpad', 'action_type', 'query']>] line_no=110, Variable token=external_tool_info point_to=[<Call func=generate_observation line_no=111 parent_token=self taken_var=['idx', 'scratchpad', 'action_type', 'query']>] line_no=110]

<Call func=append line_no=116 parent_token=steps taken_var=[<Call func=ReActStepOutput line_no=117 parent_token=None taken_var=['thought', 'action_type', 'query', 'obs', 'answer', 'external_tool_info', 'thought_response', 'action_response']>]>

[Variable token=idx point_to=['Constant'] line_no=129]


[Variable token=total_time point_to=[<Call func=time line_no=131 parent_token=time taken_var=[]>, 'start'] line_no=131]

[Variable token=total_metrics point_to=[<Call func=accumulate_metrics line_no=132 parent_token=None taken_var=['steps']>] line_no=132]

[Variable token=out point_to=[<Call func=ReActOutput line_no=133 parent_token=None taken_var=['answer', 'total_metrics', 'total_metrics', 'total_metrics', 'total_metrics', 'total_metrics', 'total_metrics', 'total_metrics', LogicStatement cond=ifExp else=['Constant'], 'steps']>] line_no=133]

After print
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
FUNC TOKEN
generate_thought
INPUT LIST
['self', 'idx', 'scratchpad', 'question', 'examples', 'prompt', 'additional_keys']
OUTPUT LIST
['scratchpad', 'thought', 'out']
AFter process
[Variable token=scratchpad point_to=['idx'] line_no=170]

[Variable token=out point_to=[<Call func=_prompt_agent line_no=172 parent_token=None taken_var=[('self', 'llm'), 'question', 'scratchpad', 'examples', ('self', 'max_steps'), 'prompt', 'additional_keys']>] line_no=172]

[Variable token=thought point_to=[<Call func=strip line_no=181 parent_token=unknown taken_var=[]>] line_no=181]

[Variable token=scratchpad point_to=['thought'] line_no=182]

After print
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
FUNC TOKEN
generate_action
INPUT LIST
['self', 'idx', 'scratchpad', 'question', 'examples', 'prompt', 'additional_keys']
OUTPUT LIST
[]
AFter process
After print
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
FUNC TOKEN
generate_observation
INPUT LIST
['self', 'idx', 'scratchpad', 'action_type', 'query']
OUTPUT LIST
[]
AFter process
After print
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
FUNC TOKEN
halting_condition
INPUT LIST
['self', 'finished', 'idx', 'question', 'scratchpad', 'examples', 'prompt', 'additional_keys']
OUTPUT LIST
["Call(func=Name(id='_is_halted', ctx=Load()), args=[], keywords=[keyword(arg='finished', value=Name(id='finished', ctx=Load())), keyword(arg='idx', value=Name(id='idx', ctx=Load())), keyword(arg='question', value=Name(id='question', ctx=Load())), keyword(arg='scratchpad', value=Name(id='scratchpad', ctx=Load())), keyword(arg='examples', value=Name(id='examples', ctx=Load())), keyword(arg='max_steps', value=Attribute(value=Name(id='self', ctx=Load()), attr='max_steps', ctx=Load())), keyword(arg='max_tokens', value=Attribute(value=Name(id='self', ctx=Load()), attr='max_tokens', ctx=Load())), keyword(arg='enc', value=Attribute(value=Name(id='self', ctx=Load()), attr='enc', ctx=Load())), keyword(arg='prompt', value=Name(id='prompt', ctx=Load())), keyword(arg='additional_keys', value=Name(id='additional_keys', ctx=Load()))])"]
AFter process
After print
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
FUNC TOKEN
reset
INPUT LIST
['self']
OUTPUT LIST
[]
AFter process
After print
[]
=================================================================================================
FILE KEY
./test/test_example10/test.py
FILE SYMBOL
      <model.File object at 0x000002A90FFE9A50>
=======
def generate(
        self,
        question: str,
        key: str,
        examples: str = "",
        prompt: str = "",
        summary_prompt: str = "",
        meta_summary_prompt: str = "",
        additional_keys: Dict[str, str] = {},
        summary_additional_keys: Dict[str, str] = {},
        meta_summary_additional_keys: Dict[str, str] = {},
        fewshot_type: str = "",
        summary_system: str = "",
        meta_summary_system: str = "",
        quadrant: str = "adapt",
        patience: int = 3,
        reset: bool = False,
    ) -> CLINOutput:
        """Generate a response to a given question.

        Args:
            question (str): The question to be answered.
            key (str): The key for the question.
            examples (str): The examples for the question. Defaults to "".
            prompt (str): The prompt for the question. Defaults to "".
            summary_prompt (str): The summary prompt for the question. Defaults to "".
            meta_summary_prompt (str): The meta-summary prompt for the question. Defaults to "".
            additional_keys (Dict[str, str]): Additional keys for the question. Defaults to {}.
            summary_additional_keys (Dict[str, str]): Additional keys for the summary. Defaults to {}.
            meta_summary_additional_keys (Dict[str, str]): Additional keys for the meta-summary. Defaults to {}.
            fewshot_type (str): The type of few-shot examples to use. Defaults to "".
            summary_system (str): The system for the summary. Defaults to "".
            meta_summary_system (str): The system for the meta-summary. Defaults to "".
            quadrant (str): The quadrant for the question. Defaults to "adapt".
            patience (int): The patience for the question. Defaults to 3.
            reset (bool): Whether to reset the agent. Defaults to False.

        Returns:
                CLINOutput: The output of the agent.
        """
        if quadrant not in ["adapt", "gen_env", "gen_task"]:
            raise ValueError(f"Quadrant '{quadrant}' not supported for CLIN.")

        if not prompt or not summary_prompt or not meta_summary_prompt or not examples:
            if not fewshot_type:
                fewshot_type = CLIN_BENCHMARK_FEWSHOTS[self.benchmark][0]  # type: ignore
            fewshots = CLIN.get_fewshots(
                benchmark=self.benchmark, fewshot_type=fewshot_type
            )
            prompts = CLIN.get_prompts(benchmark=self.benchmark)
            examples = fewshots["examples"]
            prompt = prompts["prompt"]
            summary_prompt = prompts["summary_prompt"]
            meta_summary_prompt = prompts["meta_summary_prompt"]

        if not summary_system:
            summary_system = CLIN_SUMMARY_SYSTEM[quadrant]

        if not meta_summary_system:
            meta_summary_system = CLIN_META_SUMMARY_SYSTEM[quadrant]

        out = self.strategy.generate(
            question=question,
            key=key,
            examples=examples,
            prompt=prompt,
            summary_prompt=summary_prompt,
            meta_summary_prompt=meta_summary_prompt,
            additional_keys=additional_keys,
            summary_additional_keys=summary_additional_keys,
            meta_summary_additional_keys=meta_summary_additional_keys,
            summary_system=summary_system,
            meta_summary_system=meta_summary_system,
            quadrant=quadrant,
            patience=patience,
            reset=reset,
        )

        return out
>>>>>>> Stashed changes
